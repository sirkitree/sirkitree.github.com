---
layout: default
---
<article class="post">
  <header>
    <h1 class="post-title">{{ page.title }}</h1>
    <div class="meta mb-4">
      <time pubdate="pubdate">{{ page.date | date: "%B %d, %Y" }}</time>
      {% if page.tags %}
        <span class="ms-2 me-2">•</span>
        <span class="tags">
          {% for tag in page.tags %}
            <a href="/tags/tag/?tag={{ tag | url_encode }}" class="tag">{{ tag }}</a>
            {% unless forloop.last %}<span class="tag-separator">, </span>{% endunless %}
          {% endfor %}
        </span>
      {% endif %}
    </div>
  </header>

  <section class="content">
    {{ content }}
  </section>  
  
  {% if page.tags.size > 0 %}
  {% capture related_ids %}{% for post in site.posts %}{% if post.url != page.url and post.tags %}{% for tag in page.tags %}{% if post.tags contains tag %}{{ post.url }}|{% break %}{% endif %}{% endfor %}{% endif %}{% endfor %}{% endcapture %}
  {% assign related_urls = related_ids | split: "|" | uniq %}
  {% assign related_count = 0 %}

  {% if related_urls.size > 0 %}
  <section class="related-posts mt-5">
    <h2>Related Posts</h2>
    <div class="related-posts-grid">
      {% for post in site.posts %}
        {% if related_count < 3 %}
          {% if related_urls contains post.url %}
            <div class="related-post">
              <h3><a href="{{ post.url }}">{{ post.title }}</a></h3>
              <div class="meta">
                <time>{{ post.date | date: "%B %d, %Y" }}</time>
                {% if post.tags %}
                  <span class="ms-2 me-2">•</span>
                  <span class="tags">
                    {% for tag in post.tags %}
                      <a href="/tags/tag/?tag={{ tag | url_encode }}" class="tag">{{ tag }}</a>
                      {% unless forloop.last %}<span class="tag-separator">, </span>{% endunless %}
                    {% endfor %}
                  </span>
                {% endif %}
              </div>
              {% if post.excerpt %}
                <p class="excerpt">{{ post.excerpt | strip_html | truncatewords: 30 }}</p>
              {% endif %}
            </div>
            {% assign related_count = related_count | plus: 1 %}
          {% endif %}
        {% endif %}
      {% endfor %}
    </div>
  </section>
  {% endif %}
  {% endif %}
  
</article>
